<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Products - POS</title>
  <link rel="stylesheet" href="style.css">
  <style>
    table {width:100%; border-collapse:collapse; margin-top:16px;}
    th,td{border:1px solid var(--border); padding:8px; font-size:14px;}
    .form-inline {display:flex; gap:8px; margin-top:12px;}
    .form-inline input{padding:6px;}
    .actions button{margin-right:4px;}
  </style>
</head>
<body>
  <nav class="sidebar">
    <h2>POS System</h2>
    <a href="index.html">Dashboard</a>
    <a href="products.html" class="active">Products</a>
    <a href="billing.html">Billing</a>
    <a href="sales.html">Sales</a>
    <a href="reports.html">Reports</a>
    <a href="settings.html">Settings</a>
  </nav>
  <div class="main">
    <div class="topbar">
      <div><strong>Products</strong></div>
    </div>
    <div class="content">
      <h1>Manage Products</h1>
      <div class="form-inline">
        <input id="barcode" placeholder="Barcode">
        <input id="name" placeholder="Name">
        <input id="price" type="number" step="0.01" placeholder="Price">
        <input id="stock" type="number" placeholder="Stock">
        <button onclick="addProduct()">Add</button>
      </div>
      <table>
        <thead><tr><th>Barcode</th><th>Name</th><th>Price</th><th>Stock</th><th>Actions</th></tr></thead>
        <tbody id="prodTable"></tbody>
      </table>
    </div>
  </div>

<script>
  const K={PRODS:'pos_products'};
  const DB={get:(k,f)=>{try{return JSON.parse(localStorage.getItem(k))??f}catch{return f}},set:(k,v)=>localStorage.setItem(k,JSON.stringify(v))};
  const products=()=>DB.get(K.PRODS,[]);
  const saveProducts=(p)=>DB.set(K.PRODS,p);

  function render(){
    const tb=document.getElementById('prodTable');
    tb.innerHTML='';
    for(const p of products()){
      const tr=document.createElement('tr');
      tr.innerHTML=`<td>${p.barcode}</td><td>${p.name}</td><td>${p.price}</td><td>${p.stock??0}</td><td class='actions'><button onclick='editProduct("${p.barcode}")'>Edit</button><button onclick='delProduct("${p.barcode}")'>Delete</button></td>`;
      tb.appendChild(tr);
    }
  }

  function addProduct(){
    const bc=document.getElementById('barcode').value.trim();
    const nm=document.getElementById('name').value.trim();
    const pr=parseFloat(document.getElementById('price').value);
    const st=parseInt(document.getElementById('stock').value)||0;
    if(!bc||!nm||isNaN(pr)) return alert('Fill all');
    const arr=products();
    if(arr.find(x=>x.barcode===bc)) return alert('Exists');
    arr.push({barcode:bc,name:nm,price:pr,stock:st});
    saveProducts(arr);
    render();
  }

  function editProduct(bc){
    const arr=products();
    const p=arr.find(x=>x.barcode===bc);
    if(!p) return;
    const nm=prompt('Name',p.name);
    const pr=parseFloat(prompt('Price',p.price));
    const st=parseInt(prompt('Stock',p.stock));
    if(!nm||isNaN(pr)) return;
    p.name=nm; p.price=pr; p.stock=st;
    saveProducts(arr);
    render();
  }

  function delProduct(bc){
    if(!confirm('Delete?')) return;
    let arr=products().filter(x=>x.barcode!==bc);
    saveProducts(arr);
    render();
  }

  render();
</script>
</body>
</html>
